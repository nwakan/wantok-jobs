import{$ as u,r as s,j as e}from"./index-BpglRmhx.js";function g(){const{showToast:a}=u(),[r,i]=s.useState(!1),[x,n]=s.useState(""),[c]=s.useState([{id:1,user_id:"U-1234",user_name:"John Suspicious",email:"suspicious@example.com",reason:"Multiple fake job postings",flagged_at:new Date(Date.now()-864e5).toISOString(),severity:"high"},{id:2,user_id:"U-5678",user_name:"Spam Company Inc",email:"spam@company.com",reason:"Spam applications to multiple jobs",flagged_at:new Date(Date.now()-1728e5).toISOString(),severity:"medium"}]),[o]=s.useState([{ip:"192.168.1.100",reason:"DDoS attack",blocked_at:"2024-02-10",blocked_by:"Admin"},{ip:"10.0.0.50",reason:"Scraping attempts",blocked_at:"2024-02-12",blocked_by:"System"},{ip:"172.16.0.25",reason:"Spam submissions",blocked_at:"2024-02-14",blocked_by:"Admin"}]),[m]=s.useState([{id:1,type:"Multiple login attempts",user:"user@example.com",ip:"203.0.113.45",time:new Date(Date.now()-18e5).toISOString(),severity:"high"},{id:2,type:"Rapid job applications",user:"spammer@example.com",ip:"198.51.100.23",time:new Date(Date.now()-36e5).toISOString(),severity:"medium"},{id:3,type:"Suspicious profile creation",user:"fake@example.com",ip:"192.0.2.100",time:new Date(Date.now()-72e5).toISOString(),severity:"low"}]),p=t=>{t.preventDefault(),a(`IP ${x} blocked successfully`,"success"),n(""),i(!1)},h=t=>{confirm(`Are you sure you want to unblock ${t}?`)&&a(`IP ${t} unblocked`,"success")},l=(t,d)=>{a(`Account ${t} ${d}`,"success")};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Fraud & Security Dashboard"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Flagged Accounts"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reason"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Severity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Flagged"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:"No flagged accounts"})}):c.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[t.user_name,e.jsx("p",{className:"text-xs text-gray-500",children:t.user_id})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.email}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:t.reason}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.severity==="high"?"bg-red-100 text-red-800":t.severity==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:t.severity})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.flagged_at).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2",children:[e.jsx("button",{onClick:()=>l(t.user_id,"suspended"),className:"text-orange-600 hover:text-orange-700 font-medium",children:"Suspend"}),e.jsx("button",{onClick:()=>l(t.user_id,"banned"),className:"text-red-600 hover:text-red-700 font-medium",children:"Ban"}),e.jsx("button",{onClick:()=>l(t.user_id,"cleared"),className:"text-green-600 hover:text-green-700 font-medium",children:"Clear"})]})]},t.id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Blocked IP Addresses"}),e.jsx("button",{onClick:()=>i(!r),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:r?"Cancel":"Block New IP"})]}),r&&e.jsxs("form",{onSubmit:p,className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP Address"}),e.jsx("input",{type:"text",value:x,onChange:t=>n(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",placeholder:"192.168.1.1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason"}),e.jsx("input",{type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg",placeholder:"Reason for blocking",required:!0})]})]}),e.jsx("button",{type:"submit",className:"mt-4 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Block IP"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reason"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Blocked Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Blocked By"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map((t,d)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900",children:t.ip}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:t.reason}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.blocked_at}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.blocked_by}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>h(t.ip),className:"text-green-600 hover:text-green-700 font-medium",children:"Unblock"})})]},d))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Suspicious Activity Log"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP Address"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Severity"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:t.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.user}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900",children:t.ip}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.time).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.severity==="high"?"bg-red-100 text-red-800":t.severity==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:t.severity})})]},t.id))})]})})]})]})}export{g as default};
