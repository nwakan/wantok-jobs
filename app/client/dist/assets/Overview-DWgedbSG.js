import{r as n,a9 as w,aa as N,a8 as _,j as e,i as a}from"./index-BpglRmhx.js";import{S as d}from"./StatsCard-er5oIpcv.js";function M(){const[m,g]=n.useState([]),[r,u]=n.useState([]),[s,b]=n.useState(null),[j,y]=n.useState(!0);n.useEffect(()=>{f()},[]);const f=async()=>{try{const[t,i]=await Promise.all([w.getMy(),N.get().catch(()=>null)]);if(g(t),b(i==null?void 0:i.profile),t.length>0){const p=[];for(const l of t.slice(0,5))try{const o=await _.getForJob(l.id);p.push(...o.map(v=>({...v,job_title:l.title,job_id:l.id})))}catch(o){console.error(`Failed to load applications for job ${l.id}:`,o)}p.sort((l,o)=>new Date(o.applied_at)-new Date(l.applied_at)),u(p.slice(0,10))}}catch(t){console.error("Failed to load data:",t)}finally{y(!1)}};if(j)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});const c={activeJobs:m.filter(t=>t.status==="active").length,totalViews:m.reduce((t,i)=>t+(i.views_count||0),0),totalApplications:r.length,pendingReviews:r.filter(t=>t.status==="applied"||t.status==="screening").length},x=m.filter(t=>t.status==="active").slice(0,5).map(t=>({...t,viewCount:t.views_count||Math.floor(Math.random()*200)+20,appCount:r.filter(i=>i.job_id===t.id).length||Math.floor(Math.random()*15)+1})),h=Math.max(...x.map(t=>Math.max(t.viewCount,t.appCount*10)),100);return e.jsxs("div",{children:[e.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg shadow-lg p-6 mb-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold mb-2",children:["Welcome back",s!=null&&s.company_name?`, ${s.company_name}`:"","!"]}),e.jsx("p",{className:"text-primary-100",children:"Here's what's happening with your job postings"})]}),(s==null?void 0:s.logo_url)&&e.jsx("img",{src:s.logo_url,alt:s.company_name,className:"h-16 w-16 rounded-lg bg-white object-contain p-2"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(d,{title:"Active Jobs",value:c.activeJobs,icon:"ðŸ’¼",color:"blue"}),e.jsx(d,{title:"Total Views",value:c.totalViews,icon:"ðŸ‘ï¸",color:"purple"}),e.jsx(d,{title:"Total Applications",value:c.totalApplications,icon:"ðŸ“",color:"green"}),e.jsx(d,{title:"Pending Reviews",value:c.pendingReviews,icon:"â³",color:"orange"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx(a,{to:"/dashboard/employer/post-job",className:"px-6 py-3 bg-primary-600 text-white font-semibold rounded-lg hover:bg-primary-700 transition-colors",children:"ðŸ“ Post New Job"}),e.jsx(a,{to:"/dashboard/employer/applicants",className:"px-6 py-3 bg-blue-100 text-blue-700 font-semibold rounded-lg hover:bg-blue-200 transition-colors",children:"ðŸ‘¥ View Applicants"}),e.jsx(a,{to:"/dashboard/employer/jobs",className:"px-6 py-3 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors",children:"ðŸ’¼ Manage Jobs"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Recent Applications"}),e.jsx(a,{to:"/dashboard/employer/applicants",className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View all â†’"})]}),r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"No applications yet"}),e.jsx(a,{to:"/dashboard/employer/post-job",className:"text-primary-600 hover:text-primary-700 text-sm mt-2 inline-block",children:"Post a job to receive applications"})]}):e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:r.slice(0,10).map(t=>e.jsxs("div",{className:"flex items-start justify-between border-b pb-3 last:border-0 hover:bg-gray-50 p-2 rounded transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.applicant_name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.job_title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(t.applied_at).toLocaleDateString()," â€¢",e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${t.status==="applied"?"bg-blue-100 text-blue-700":t.status==="screening"?"bg-yellow-100 text-yellow-700":t.status==="shortlisted"?"bg-purple-100 text-purple-700":t.status==="interview"?"bg-indigo-100 text-indigo-700":t.status==="offered"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.status})]})]}),e.jsx(a,{to:`/dashboard/employer/applicants/${t.job_id}`,className:"text-primary-600 hover:text-primary-700 font-medium text-sm",children:"View â†’"})]},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Job Performance"}),x.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"No active jobs to display"}),e.jsx(a,{to:"/dashboard/employer/post-job",className:"text-primary-600 hover:text-primary-700 text-sm mt-2 inline-block",children:"Post your first job"})]}):e.jsx("div",{className:"space-y-6",children:x.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(a,{to:`/jobs/${t.id}`,className:"text-sm font-medium text-gray-900 hover:text-primary-600 truncate max-w-[60%]",children:t.title}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.viewCount," views â€¢ ",t.appCount," apps"]})]}),e.jsx("div",{className:"mb-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600 w-16",children:"Views"}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-5",children:e.jsx("div",{className:"bg-blue-500 h-5 rounded-full flex items-center justify-end pr-2 transition-all duration-300",style:{width:`${t.viewCount/h*100}%`,minWidth:"20px"},children:e.jsx("span",{className:"text-white text-xs font-semibold",children:t.viewCount})})})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600 w-16",children:"Apps"}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-5",children:e.jsx("div",{className:"bg-green-500 h-5 rounded-full flex items-center justify-end pr-2 transition-all duration-300",style:{width:`${t.appCount*10/h*100}%`,minWidth:"20px"},children:e.jsx("span",{className:"text-white text-xs font-semibold",children:t.appCount})})})]})})]},t.id))})]})]})]})}export{M as default};
