import{u as b,n as f,$ as N,r as n,j as e,A as u,T as w,ad as v,W as k,a as _,b as A,M as S,k as C,D as $,N as B,a8 as F}from"./index-BpglRmhx.js";import{A as E}from"./ApplicationStatusBadge-QPEmW8FA.js";function T(){const[d]=b(),l=f(),{showToast:i}=N(),[a,x]=n.useState([]),[o,m]=n.useState(!0),c=d.get("ids");n.useEffect(()=>{if(!c){l(-1);return}h()},[c]);const h=async()=>{try{const s=await fetch(`/api/applications/compare?ids=${c}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!s.ok)throw new Error("Failed to load applicants");const t=await s.json();x(t.data||[])}catch(s){console.error("Failed to load applicants:",s),i("Failed to load applicants for comparison","error"),l(-1)}finally{m(!1)}},g=async s=>{try{await F.updateStatus(s,"shortlisted"),i("Applicant moved to shortlisted!","success"),setTimeout(()=>l(-1),1500)}catch(t){i("Failed to update status: "+t.message,"error")}},y=s=>s>=80?"bg-green-100 text-green-800 border-green-300":s>=50?"bg-yellow-100 text-yellow-800 border-yellow-300":"bg-red-100 text-red-800 border-red-300",p=()=>Math.max(...a.map(s=>s.rating||0)),j=()=>Math.max(...a.map(s=>s.ai_score||0));return o?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>l(-1),className:"flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(u,{className:"h-5 w-5 mr-2"}),"Back to Applicants"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Compare Candidates"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Side-by-side comparison of ",a.length," candidates"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"py-4 px-6 text-left text-sm font-semibold text-gray-700 w-48 sticky left-0 bg-gray-50 z-10",children:"Criteria"}),a.map(s=>{var t,r;return e.jsx("th",{className:"py-4 px-6 text-center min-w-[250px]",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white text-2xl font-bold mb-2",children:((r=(t=s.applicant_name)==null?void 0:t.charAt(0))==null?void 0:r.toUpperCase())||"?"}),e.jsx("div",{className:"font-semibold text-gray-900",children:s.applicant_name}),e.jsx(E,{status:s.status})]})},s.id)})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-5 w-5 mr-2 text-blue-600"}),"Match Score"]})}),a.map(s=>{const t=s.ai_score===j();return e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsxs("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-lg font-bold border-2 ${y(s.ai_score||0)} ${t?"ring-2 ring-green-500 ring-offset-2":""}`,children:[s.ai_score||0,"%"]})},s.id)})]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-5 w-5 mr-2 text-yellow-600"}),"Your Rating"]})}),a.map(s=>{const t=s.rating===p();return e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("div",{className:`flex justify-center ${t?"scale-110":""}`,children:[1,2,3,4,5].map(r=>e.jsx(k,{className:`h-6 w-6 ${r<=(s.rating||0)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},r))})},s.id)})]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:"Headline"}),a.map(s=>e.jsx("td",{className:"py-4 px-6 text-center",children:e.jsx("p",{className:"text-gray-700",children:s.headline||"N/A"})},s.id))]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:"Contact"}),a.map(s=>e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center text-gray-600",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),s.applicant_email]}),s.phone&&e.jsxs("div",{className:"flex items-center justify-center text-gray-600",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),s.phone]})]})},s.id))]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-5 w-5 mr-2 text-red-600"}),"Location"]})}),a.map(s=>e.jsx("td",{className:"py-4 px-6 text-center text-gray-700",children:s.applicant_location||"Not specified"},s.id))]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:"Skills"}),a.map(s=>e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[(s.skills||[]).slice(0,5).map((t,r)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:typeof t=="string"?t:t.name||t.skill},r)),(s.skills||[]).length>5&&e.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs",children:["+",(s.skills||[]).length-5," more"]})]})},s.id))]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-5 w-5 mr-2 text-purple-600"}),"Experience"]})}),a.map(s=>e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[(s.work_history||[]).slice(0,2).map((t,r)=>e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.title}),e.jsx("div",{className:"text-gray-600",children:t.company}),e.jsxs("div",{className:"text-gray-500 text-xs",children:[t.start_date?new Date(t.start_date).getFullYear():"?"," - ",t.end_date?new Date(t.end_date).getFullYear():"Present"]})]},r)),(s.work_history||[]).length>2&&e.jsxs("div",{className:"text-center text-gray-500 text-xs",children:["+",(s.work_history||[]).length-2," more positions"]}),(!s.work_history||s.work_history.length===0)&&e.jsx("div",{className:"text-center text-gray-500",children:"No experience listed"})]})},s.id))]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"h-5 w-5 mr-2 text-green-600"}),"Education"]})}),a.map(s=>e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[(s.education||[]).slice(0,2).map((t,r)=>e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.degree}),e.jsx("div",{className:"text-gray-600",children:t.institution}),e.jsx("div",{className:"text-gray-500 text-xs",children:t.year})]},r)),(!s.education||s.education.length===0)&&e.jsx("div",{className:"text-center text-gray-500",children:"No education listed"})]})},s.id))]}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:"Cover Letter"}),a.map(s=>e.jsx("td",{className:"py-4 px-6",children:e.jsx("p",{className:"text-sm text-gray-700 text-left line-clamp-3",children:s.cover_letter||"No cover letter provided"})},s.id))]}),a.some(s=>s.tags&&s.tags.length>0)&&e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 font-semibold text-gray-700 sticky left-0 bg-white",children:"Tags"}),a.map(s=>e.jsx("td",{className:"py-4 px-6",children:e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:(s.tags||[]).map((t,r)=>e.jsx("span",{className:`px-3 py-1 bg-${t.color||"gray"}-100 text-${t.color||"gray"}-800 rounded-full text-xs font-medium`,children:t.tag||t},r))})},s.id))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-6 px-6 font-semibold text-gray-700 sticky left-0 bg-gray-50",children:"Actions"}),a.map(s=>e.jsx("td",{className:"py-6 px-6 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:()=>g(s.id),className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium flex items-center justify-center",children:["Select Winner ",e.jsx(B,{className:"h-4 w-4 ml-2"})]}),e.jsx("button",{onClick:()=>l(`/dashboard/employer/applicants/${s.id}`),className:"w-full px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:"View Full Profile"})]})},s.id))]})]})]})})]})})}export{T as default};
