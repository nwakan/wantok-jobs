import{r,$ as w,aq as o,j as e}from"./index-BpglRmhx.js";function v(){const[l,i]=r.useState([]),[s,c]=r.useState(null),[g,h]=r.useState(!0),[n,b]=r.useState("all"),{showToast:m}=w(),[y,x]=r.useState("");r.useEffect(()=>{u()},[]);const u=async()=>{try{const t=await o.getAll();i(t||[])}catch(t){console.error("Failed to load contact messages:",t),i([{id:1,name:"Sarah Johnson",email:"sarah@example.com",subject:"Inquiry about premium features",message:"I would like to know more about the premium employer features and pricing...",status:"new",created_at:new Date().toISOString()},{id:2,name:"Michael Chen",email:"michael@example.com",subject:"Technical issue with job posting",message:"I am unable to upload my company logo when posting a job...",status:"read",created_at:new Date(Date.now()-864e5).toISOString()},{id:3,name:"Emma Wilson",email:"emma@example.com",subject:"Partnership opportunity",message:"We are interested in partnering with WantokJobs for our career fair...",status:"replied",created_at:new Date(Date.now()-1728e5).toISOString()}])}finally{h(!1)}},j=async t=>{if(c(t),t.status==="new")try{await o.updateStatus(t.id,"read"),i(l.map(a=>a.id===t.id?{...a,status:"read"}:a))}catch(a){console.error("Failed to update status:",a)}},f=async t=>{t.preventDefault();try{await o.updateStatus(s.id,"replied"),m("Reply sent successfully","success"),x(""),u(),c({...s,status:"replied"})}catch{m("Failed to send reply","error")}},p=n==="all"?l:l.filter(t=>t.status===n),d=l.filter(t=>t.status==="new").length;return g?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Form Messages"}),d>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[d," new message",d!==1?"s":""]})]}),e.jsx("div",{className:"flex gap-2",children:["all","new","read","replied"].map(t=>e.jsx("button",{onClick:()=>b(t),className:`px-4 py-2 rounded-lg font-medium capitalize ${n===t?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:t},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200",children:p.length===0?e.jsx("p",{className:"p-6 text-center text-gray-500",children:"No messages found"}):p.map(t=>e.jsxs("div",{onClick:()=>j(t),className:`p-4 cursor-pointer transition-colors ${t.status==="new"?"bg-blue-50":"hover:bg-gray-50"} ${(s==null?void 0:s.id)===t.id?"bg-gray-100":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("p",{className:`font-semibold text-sm ${t.status==="new"?"text-gray-900":"text-gray-700"}`,children:t.name}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.status==="new"?"bg-blue-100 text-blue-800":t.status==="replied"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.status})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:t.subject}),e.jsx("p",{className:"text-xs text-gray-500 truncate mb-1",children:t.message}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.created_at).toLocaleDateString()})]},t.id))})}),e.jsx("div",{className:"lg:col-span-2 bg-white rounded-lg shadow-sm p-6",children:s?e.jsxs("div",{children:[e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s.subject}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${s.status==="new"?"bg-blue-100 text-blue-800":s.status==="replied"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.status})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{children:s.email}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(s.created_at).toLocaleString()})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Message:"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:s.message})]}),s.status!=="replied"&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Reply"}),e.jsxs("form",{onSubmit:f,children:[e.jsx("textarea",{value:y,onChange:t=>x(t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg mb-4",rows:"6",placeholder:"Type your reply here...",required:!0}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Send Reply"})]})]}),s.status==="replied"&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-800 text-sm",children:"âœ“ This message has been replied to"})})]}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Select a message to view"})})]})]})}export{v as default};
