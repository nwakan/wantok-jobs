import{j as t,S as h,ap as j,aY as N,B as v,aZ as b,aX as w}from"./vendor-ui-K43rUeTs.js";import{u as _,r as o}from"./vendor-react-Dlyf-RJj.js";import{c as S,m as c}from"./index-CAGaxXNg.js";function L(){const{showToast:l}=S(),m=_(),[r,n]=o.useState([]),[d,x]=o.useState(!0);o.useEffect(()=>{y()},[]);const y=async()=>{try{const e=await c.getAll();n((e==null?void 0:e.searches)||[])}catch(e){console.error("Failed to load saved searches:",e),l("Failed to load saved searches","error")}finally{x(!1)}},f=async e=>{try{const a=await c.toggleNotify(e);n(s=>s.map(i=>i.id===e?{...i,notify:a.notify?1:0}:i)),l(a.notify?"Notifications enabled ðŸ””":"Notifications disabled","success")}catch{l("Failed to update notifications","error")}},g=async e=>{if(confirm("Delete this saved search?"))try{await c.remove(e),n(a=>a.filter(s=>s.id!==e)),l("Saved search deleted","success")}catch{l("Failed to delete","error")}},p=e=>{const a=new URLSearchParams;e.query&&a.set("keyword",e.query),e.category&&a.set("category",e.category),e.location&&a.set("location",e.location),e.experience_level&&a.set("experience",e.experience_level),e.salary_min&&a.set("salary_min",e.salary_min),e.salary_max&&a.set("salary_max",e.salary_max),m(`/jobs?${a.toString()}`)},u=e=>{const a=[];if(e.query&&a.push(`"${e.query}"`),e.category&&a.push(e.category),e.location&&a.push(e.location),e.experience_level&&a.push(e.experience_level),e.salary_min||e.salary_max){const s=e.salary_min?`K${e.salary_min.toLocaleString()}`:"",i=e.salary_max?`K${e.salary_max.toLocaleString()}`:"";a.push(s&&i?`${s}â€“${i}`:s||i)}return a.join(" Â· ")||"All jobs"};return d?t.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(e=>t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 h-24"},e))}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Saved Searches"}),t.jsxs("span",{className:"text-sm text-gray-500",children:[r.length,"/20 searches"]})]}),r.length===0?t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[t.jsx(h,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No saved searches yet"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Search for jobs and save your criteria to quickly run them again later."}),t.jsx("button",{onClick:()=>m("/jobs"),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Browse Jobs"})]}):t.jsx("div",{className:"space-y-3",children:r.map(e=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-5 flex flex-col sm:flex-row sm:items-center gap-4",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:e.name}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:u(e)}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-400",children:[t.jsxs("span",{className:"font-medium text-primary-600",children:[e.match_count," matching jobs"]}),e.last_notified_at&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(j,{className:"w-3 h-3"}),"Last notified ",new Date(e.last_notified_at).toLocaleDateString()]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[t.jsxs("button",{onClick:()=>p(e),className:"inline-flex items-center gap-1 px-3 py-1.5 text-sm bg-primary-50 text-primary-700 rounded-lg hover:bg-primary-100",title:"Run this search",children:[t.jsx(N,{className:"w-4 h-4"}),"Run"]}),t.jsx("button",{onClick:()=>f(e.id),className:`p-2 rounded-lg ${e.notify?"text-primary-600 bg-primary-50 hover:bg-primary-100":"text-gray-400 hover:bg-gray-100"}`,title:e.notify?"Notifications on":"Notifications off",children:e.notify?t.jsx(v,{className:"w-4 h-4"}):t.jsx(b,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>g(e.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:t.jsx(w,{className:"w-4 h-4"})})]})]},e.id))})]})}export{L as default};
