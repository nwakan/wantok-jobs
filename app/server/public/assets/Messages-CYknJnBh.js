import{r as l,Y as f,ad as x,j as e}from"./index-BNk0NZme.js";function v(){const[n,d]=l.useState([]),[t,p]=l.useState(null),[h,b]=l.useState(!0),[c,o]=l.useState(!1),{showToast:u}=f(),[a,i]=l.useState({recipient_id:"",subject:"",message:""});l.useEffect(()=>{g()},[]);const g=async()=>{try{const s=await x.getAll();d(s||[])}catch(s){console.error("Failed to load messages:",s),d([{id:1,from_name:"John Employer",subject:"Question about posting jobs",message:"I need help understanding the job posting limits...",read:!1,created_at:new Date().toISOString()},{id:2,from_name:"Jane Jobseeker",subject:"Profile verification issue",message:"My profile verification has been pending for 3 days...",read:!0,created_at:new Date(Date.now()-864e5).toISOString()}])}finally{b(!1)}},j=async s=>{if(p(s),!s.read)try{await x.markRead(s.id),d(n.map(r=>r.id===s.id?{...r,read:!0}:r))}catch(r){console.error("Failed to mark as read:",r)}},y=async s=>{s.preventDefault();try{await x.send(a),u("Message sent successfully","success"),o(!1),i({recipient_id:"",subject:"",message:""}),g()}catch{u("Failed to send message","error")}},m=n.filter(s=>!s.read).length;return h?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Messages"}),m>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[m," unread message",m!==1?"s":""]})]}),e.jsx("button",{onClick:()=>o(!c),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:c?"Cancel":"Compose Message"})]}),c&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"New Message"}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient User ID"}),e.jsx("input",{type:"text",value:a.recipient_id,onChange:s=>i({...a,recipient_id:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",placeholder:"Enter user ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:a.subject,onChange:s=>i({...a,subject:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:a.message,onChange:s=>i({...a,message:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",rows:"6",required:!0})]}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Send Message"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200",children:n.length===0?e.jsx("p",{className:"p-6 text-center text-gray-500",children:"No messages"}):n.map(s=>e.jsxs("div",{onClick:()=>j(s),className:`p-4 cursor-pointer transition-colors ${s.read?"hover:bg-gray-50":"bg-blue-50"} ${(t==null?void 0:t.id)===s.id?"bg-gray-100":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("p",{className:`font-semibold text-sm ${s.read?"text-gray-700":"text-gray-900"}`,children:s.from_name}),!s.read&&e.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full"})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:s.subject}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(s.created_at).toLocaleDateString()})]},s.id))})}),e.jsx("div",{className:"lg:col-span-2 bg-white rounded-lg shadow-sm p-6",children:t?e.jsxs("div",{children:[e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:t.subject}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:t.from_name}),e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("span",{children:new Date(t.created_at).toLocaleString()})]})]}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.message})}),e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsx("button",{onClick:()=>{i({recipient_id:t.from_id||"",subject:`Re: ${t.subject}`,message:""}),o(!0)},className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Reply"})})]}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Select a message to view"})})]})]})}export{v as default};
