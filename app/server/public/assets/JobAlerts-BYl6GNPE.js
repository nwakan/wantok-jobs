import{j as e}from"./vendor-ui-K43rUeTs.js";import{r as o}from"./vendor-react-Dlyf-RJj.js";import{c as F,h as c,j as S}from"./index-CAGaxXNg.js";function M(){const{showToast:n}=F(),[x,h]=o.useState([]),[y,b]=o.useState(!0),[u,i]=o.useState(!1),[d,p]=o.useState(null),[g,j]=o.useState({}),[t,r]=o.useState({keywords:"",location:"",job_type:"",salary_min:"",frequency:"daily",channel:"email",active:1});o.useEffect(()=>{m()},[]);const m=async()=>{try{const s=await c.getAll(),a=(s==null?void 0:s.alerts)||(Array.isArray(s)?s:[]);h(a),a.forEach(l=>{f(l)})}catch(s){console.error("Failed to load alerts:",s),h([])}finally{b(!1)}},f=async s=>{var a;try{const l={};s.keywords&&(l.search=s.keywords),s.location&&(l.location=s.location),s.job_type&&(l.type=s.job_type);const A=((a=(await S.getAll(l)).data)==null?void 0:a.length)||0;j(_=>({..._,[s.id]:A}))}catch(l){console.error("Failed to load matching jobs:",l)}},v=async()=>{if(!t.keywords&&!t.location&&!t.job_type){n("Please fill in at least one filter (keywords, location, or job type)","error");return}try{d?(await c.update(d,t),n("Job alert updated! ðŸŽ¯","success")):(await c.create(t),n("Job alert created! ðŸŽ¯","success")),i(!1),p(null),r({keywords:"",location:"",job_type:"",salary_min:"",frequency:"daily",channel:"email",active:1}),m()}catch(s){n("Failed to save alert: "+(s.message||"Unknown error"),"error")}},N=s=>{r({keywords:s.keywords||"",location:s.location||"",job_type:s.job_type||"",salary_min:s.salary_min||"",frequency:s.frequency||"daily",channel:s.channel||"email",active:s.active}),p(s.id),i(!0)},w=async(s,a)=>{try{await c.update(s,{active:a?0:1}),n(a?"Alert paused â¸ï¸":"Alert activated âœ…","success"),m()}catch{n("Failed to update alert","error")}},k=async s=>{if(confirm("Delete this alert? You won't receive notifications for matching jobs anymore."))try{await c.remove(s),n("Alert deleted ðŸ—‘ï¸","success"),m()}catch{n("Failed to delete alert","error")}},C=()=>{i(!1),p(null),r({keywords:"",location:"",job_type:"",salary_min:"",frequency:"daily",channel:"email",active:1})};return y?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Job Alerts"}),e.jsx("p",{className:"text-gray-600",children:"Get notified when jobs matching your criteria are posted"})]}),e.jsx("button",{onClick:()=>i(!u),className:"px-5 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 font-medium transition shadow-md",children:u?"âœ• Cancel":"+ New Alert"})]}),u&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg border-2 border-primary-500 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:d?"âœï¸ Edit Alert":"âž• Create New Alert"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Keywords ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(job title, skills, etc.)"})]}),e.jsx("input",{type:"text",value:t.keywords,onChange:s=>r({...t,keywords:s.target.value}),placeholder:"e.g. accountant, driver, software developer",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-2 focus:border-primary-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",value:t.location,onChange:s=>r({...t,location:s.target.value}),placeholder:"e.g. Port Moresby, Lae",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-2 focus:border-primary-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Job Type"}),e.jsxs("select",{value:t.job_type,onChange:s=>r({...t,job_type:s.target.value}),className:"w-full border-2 border-gray-300 rounded-lg px-4 py-2 focus:border-primary-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"full-time",children:"Full-time"}),e.jsx("option",{value:"part-time",children:"Part-time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"casual",children:"Casual"}),e.jsx("option",{value:"internship",children:"Internship"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Min Salary (PGK)"}),e.jsx("input",{type:"number",value:t.salary_min,onChange:s=>r({...t,salary_min:s.target.value}),placeholder:"e.g. 2000",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-2 focus:border-primary-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Frequency"}),e.jsxs("select",{value:t.frequency,onChange:s=>r({...t,frequency:s.target.value}),className:"w-full border-2 border-gray-300 rounded-lg px-4 py-2 focus:border-primary-500 focus:outline-none",children:[e.jsx("option",{value:"instant",children:"Instant (as soon as posted)"}),e.jsx("option",{value:"daily",children:"Daily digest"}),e.jsx("option",{value:"weekly",children:"Weekly digest"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Notification Channel"}),e.jsxs("select",{value:t.channel,onChange:s=>r({...t,channel:s.target.value}),className:"w-full border-2 border-gray-300 rounded-lg px-4 py-2 focus:border-primary-500 focus:outline-none",children:[e.jsx("option",{value:"email",children:"ðŸ“§ Email"}),e.jsx("option",{value:"sms",children:"ðŸ“± SMS"}),e.jsx("option",{value:"whatsapp",children:"ðŸ’¬ WhatsApp"}),e.jsx("option",{value:"push",children:"ðŸ”” In-app"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:v,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 font-medium transition",children:d?"ðŸ’¾ Update Alert":"âœ… Create Alert"}),e.jsx("button",{onClick:C,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium transition",children:"Cancel"})]})]}),x.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ””"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No alerts yet"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Create a job alert and we'll notify you when matching jobs are posted.",e.jsx("br",{}),"Our AI matches your profile for the best results!"]}),e.jsx("button",{onClick:()=>i(!0),className:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 font-medium",children:"Create Your First Alert"})]}):e.jsx("div",{className:"space-y-4",children:x.map(s=>{const a=g[s.id];return e.jsx("div",{className:`bg-white rounded-lg shadow-md border-l-4 p-6 transition ${s.active?"border-primary-500 hover:shadow-lg":"border-gray-300 opacity-60"}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"font-bold text-gray-900 text-lg",children:[s.keywords||"All jobs",s.location&&e.jsxs("span",{className:"text-gray-500 font-normal",children:[" in ",s.location]})]}),!s.active&&e.jsx("span",{className:"px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-xs font-semibold",children:"â¸ï¸ Paused"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-3",children:[s.job_type&&e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm font-medium",children:["ðŸ’¼ ",s.job_type]}),s.salary_min&&e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-lg text-sm font-medium",children:["ðŸ’° K",parseInt(s.salary_min).toLocaleString(),"+"]}),e.jsxs("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-lg text-sm font-medium",children:["ðŸ”” ",s.frequency]}),e.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium",children:[s.channel==="email"&&"ðŸ“§",s.channel==="sms"&&"ðŸ“±",s.channel==="whatsapp"&&"ðŸ’¬",s.channel==="push"&&"ðŸ””"," ",s.channel]})]}),a!==void 0&&e.jsxs("p",{className:"text-sm text-gray-600 bg-blue-50 px-3 py-2 rounded inline-block",children:["ðŸ“Š ",e.jsx("span",{className:"font-semibold",children:a})," matching job",a!==1?"s":""," currently available"]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>N(s),className:"px-3 py-2 text-sm rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 font-medium transition",title:"Edit alert",children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>w(s.id,s.active),className:`px-3 py-2 text-sm rounded-lg font-medium transition ${s.active?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:s.active?"â¸ï¸ Pause":"â–¶ï¸ Activate"}),e.jsx("button",{onClick:()=>k(s.id),className:"px-3 py-2 text-sm rounded-lg bg-red-100 text-red-700 hover:bg-red-200 font-medium transition",children:"ðŸ—‘ï¸ Delete"})]})]})},s.id)})}),x.length>0&&e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ’¡"}),e.jsx("span",{children:"Job Alert Tips"})]}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"â€¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Be specific:"}),' Use detailed keywords for better matches (e.g., "senior accountant" vs "accountant")']})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"â€¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Multiple alerts:"})," Create separate alerts for different job types to stay organized"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"â€¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Frequency:"}),' Choose "instant" for urgent job search, or "daily" to reduce notifications']})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-600 font-bold",children:"â€¢"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Review regularly:"})," Update your alerts as your job search evolves"]})]})]})]})]})}export{M as default};
