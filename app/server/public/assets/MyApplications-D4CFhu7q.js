import{j as e}from"./vendor-ui-K43rUeTs.js";import{r as d,L as h}from"./vendor-react-Dlyf-RJj.js";import{g as $}from"./index-CAGaxXNg.js";function D(){const[i,b]=d.useState([]),[j,v]=d.useState(!0),[r,a]=d.useState("all"),[x,y]=d.useState("date");d.useEffect(()=>{p()},[]);const p=async()=>{try{const t=await $.getMy(),s=(t==null?void 0:t.data)||(Array.isArray(t)?t:[]);b(s)}catch(t){console.error("Failed to load applications:",t),b([])}finally{v(!1)}},N=async t=>{if(confirm("Are you sure you want to withdraw this application? This cannot be undone."))try{await fetch(`/api/applications/${t}/withdraw`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),p()}catch(s){console.error("Failed to withdraw application:",s)}},c=[...r==="all"?i:i.filter(t=>t.status===r)].sort((t,s)=>{if(x==="date")return new Date(s.applied_at)-new Date(t.applied_at);{const o={hired:0,offered:1,interviewed:2,shortlisted:3,reviewed:4,pending:5,rejected:6,withdrawn:7};return(o[t.status]||10)-(o[s.status]||10)}}),n={pending:{label:"Pending",color:"bg-gray-100 text-gray-800 border-gray-300",icon:"‚è≥",step:1},reviewed:{label:"Reviewed",color:"bg-blue-100 text-blue-800 border-blue-300",icon:"üëÅÔ∏è",step:2},shortlisted:{label:"Shortlisted",color:"bg-yellow-100 text-yellow-800 border-yellow-300",icon:"‚≠ê",step:3},interviewed:{label:"Interviewed",color:"bg-purple-100 text-purple-800 border-purple-300",icon:"üéØ",step:4},offered:{label:"Offered",color:"bg-green-100 text-green-800 border-green-300",icon:"üéâ",step:5},hired:{label:"Hired",color:"bg-emerald-100 text-emerald-800 border-emerald-300",icon:"‚úÖ",step:6},rejected:{label:"Rejected",color:"bg-red-100 text-red-800 border-red-300",icon:"‚ùå",step:0},withdrawn:{label:"Withdrawn",color:"bg-gray-100 text-gray-500 border-gray-300",icon:"‚Ü©Ô∏è",step:0}},l={all:i.length,pending:i.filter(t=>t.status==="pending").length,reviewed:i.filter(t=>t.status==="reviewed").length,shortlisted:i.filter(t=>t.status==="shortlisted").length,interviewed:i.filter(t=>t.status==="interviewed").length,offered:i.filter(t=>t.status==="offered").length,hired:i.filter(t=>t.status==="hired").length,rejected:i.filter(t=>t.status==="rejected").length},S=({status:t})=>{var u;const s=((u=n[t])==null?void 0:u.step)||0,o=["Pending","Reviewed","Shortlisted","Interviewed","Offered","Hired"];return t==="rejected"||t==="withdrawn"?e.jsx("div",{className:"flex items-center justify-center py-2",children:e.jsxs("span",{className:`px-4 py-2 rounded-full font-semibold text-sm ${n[t].color}`,children:[n[t].icon," ",n[t].label]})}):e.jsx("div",{className:"flex items-center gap-2 py-3",children:o.map((f,w)=>{const g=w+1,m=g<=s,k=g===s;return e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition ${m?"bg-primary-500 text-white":"bg-gray-200 text-gray-500"}`,children:m?"‚úì":g}),e.jsx("p",{className:`text-xs mt-1 font-medium ${k?"text-primary-600":m?"text-gray-700":"text-gray-400"}`,children:f})]}),w<o.length-1&&e.jsx("div",{className:`flex-1 h-1 -mt-6 ${g<s?"bg-primary-500":"bg-gray-200"}`})]},f)})})};return j?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"My Applications"}),e.jsx("p",{className:"text-gray-600",children:"Track all your job applications in one place"})]}),e.jsxs("div",{className:"mb-6 flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>a("all"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="all"?"bg-primary-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:["All (",l.all,")"]}),e.jsxs("button",{onClick:()=>a("pending"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="pending"?"bg-gray-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:["‚è≥ Pending (",l.pending,")"]}),e.jsxs("button",{onClick:()=>a("reviewed"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="reviewed"?"bg-blue-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:["üëÅÔ∏è Reviewed (",l.reviewed,")"]}),e.jsxs("button",{onClick:()=>a("shortlisted"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="shortlisted"?"bg-yellow-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:["‚≠ê Shortlisted (",l.shortlisted,")"]}),e.jsxs("button",{onClick:()=>a("interviewed"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="interviewed"?"bg-purple-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:["üéØ Interviewed (",l.interviewed,")"]}),e.jsxs("button",{onClick:()=>a("offered"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="offered"?"bg-green-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:["üéâ Offered (",l.offered,")"]}),e.jsxs("button",{onClick:()=>a("hired"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="hired"?"bg-emerald-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:["‚úÖ Hired (",l.hired,")"]})]}),e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-semibold",children:c.length})," application",c.length!==1?"s":""]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y("date"),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${x==="date"?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"üìÖ Sort by Date"}),e.jsx("button",{onClick:()=>y("status"),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${x==="status"?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"üìä Sort by Status"})]})]}),c.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üìã"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:r==="all"?"No applications yet":`No ${r} applications`}),e.jsx("p",{className:"text-gray-600 mb-6",children:r==="all"?"Start applying to jobs that match your skills and experience":`You don't have any applications with status: ${r}`}),r==="all"?e.jsx(h,{to:"/jobs",className:"inline-block px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 font-medium",children:"Browse Jobs"}):e.jsx("button",{onClick:()=>a("all"),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"View All Applications"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-6",children:c.map(t=>{const s=n[t.status]||n.applied;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md border-2 border-gray-200 hover:border-primary-500 transition overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b bg-gradient-to-r from-gray-50 to-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(h,{to:`/jobs/${t.job_id}`,className:"text-2xl font-bold text-gray-900 hover:text-primary-600 transition",children:t.job_title}),e.jsx("p",{className:"text-lg text-gray-700 font-medium mt-1",children:t.company_name})]}),e.jsxs("span",{className:`px-4 py-2 rounded-full font-semibold text-sm border-2 ${s.color}`,children:[s.icon," ",s.label]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["üìç ",t.location]}),e.jsxs("span",{children:["üíº ",t.job_type]}),t.salary_min&&t.salary_max&&e.jsxs("span",{children:["üí∞ ",t.salary_currency||"K",t.salary_min.toLocaleString()," - ",t.salary_currency||"K",t.salary_max.toLocaleString()]}),e.jsxs("span",{className:"text-gray-500",children:["‚Ä¢ Applied ",new Date(t.applied_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50",children:e.jsx(S,{status:t.status})}),t.cover_letter&&e.jsx("div",{className:"px-6 py-4 border-t bg-white",children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer text-sm font-semibold text-gray-700 hover:text-primary-600 list-none flex items-center justify-between",children:[e.jsx("span",{children:"üìÑ Your Cover Letter"}),e.jsx("svg",{className:"w-5 h-5 transition group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-4 rounded-lg mt-3 whitespace-pre-wrap border border-gray-200",children:t.cover_letter})]})}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t flex gap-2",children:[e.jsx(h,{to:`/jobs/${t.job_id}`,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 font-medium text-sm transition",children:"View Job Details"}),(t.status==="offered"||t.status==="interviewed"||t.status==="hired")&&e.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium text-sm transition",children:"üìß Contact Employer"}),!["withdrawn","rejected","hired"].includes(t.status)&&e.jsx("button",{onClick:()=>N(t.id),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-red-100 hover:text-red-700 font-medium text-sm transition",children:"‚Ü©Ô∏è Withdraw"})]})]},t.id)})})]})}export{D as default};
