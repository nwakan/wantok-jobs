import{j as e,u as y,aM as T,a as $,bm as D,aX as F,X as P}from"./vendor-ui-K43rUeTs.js";import{r as a}from"./vendor-react-Dlyf-RJj.js";import{u as I,c as O,D as N,O as U}from"./index-CAGaxXNg.js";const m="/api";function p(){return{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}}const w={company_name:"",logo_url:"",industry:"",location:"",website:"",contact_name:"",contact_email:"",contact_phone:"",description:""};function R(){const{user:i}=I(),{showToast:r}=O(),[u,v]=a.useState([]),[C,_]=a.useState(!0),[k,l]=a.useState(!1),[n,g]=a.useState(null),[c,o]=a.useState({...w}),[f,j]=a.useState(!1),x=async()=>{try{const s=await(await fetch(`${m}/agency/clients`,{headers:p()})).json();v(s.data||[])}catch{r("Failed to load clients","error")}finally{_(!1)}};a.useEffect(()=>{x()},[]);const b=()=>{g(null),o({...w}),l(!0)},S=t=>{g(t),o({...t}),l(!0)},E=async()=>{if(!c.company_name.trim()){r("Company name required","error");return}j(!0);try{const t=n?`${m}/agency/clients/${n.id}`:`${m}/agency/clients`,d=await fetch(t,{method:n?"PUT":"POST",headers:p(),body:JSON.stringify(c)}),h=await d.json();if(!d.ok)throw new Error(h.error);r(n?"Client updated":"Client created","success"),l(!1),x()}catch(t){r(t.message,"error")}finally{j(!1)}},A=async t=>{if(confirm("Delete this client?"))try{if(!(await fetch(`${m}/agency/clients/${t}`,{method:"DELETE",headers:p()})).ok)throw new Error("Failed");r("Client deleted","success"),x()}catch{r("Failed to delete","error")}};return(i==null?void 0:i.account_type)!=="agency"?e.jsx(N,{role:"employer",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(y,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Agency Feature"}),e.jsx("p",{className:"text-gray-500",children:"This feature is available for recruitment agency accounts only."})]})}):e.jsxs(N,{role:"employer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Client Companies"}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700",children:[e.jsx(T,{className:"w-4 h-4"})," Add Client"]})]}),C?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading..."}):u.length===0?e.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-sm",children:[e.jsx(y,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No client companies yet"}),e.jsx("button",{onClick:b,className:"bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700",children:"Add Your First Client"})]}):e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Company"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Industry"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Location"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-600",children:"Active Jobs"}),e.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:u.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.logo_url?e.jsx(U,{src:t.logo_url,alt:"",width:32,height:32,className:"w-8 h-8 rounded object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded flex items-center justify-center",children:e.jsx(y,{className:"w-4 h-4 text-gray-400"})}),e.jsx("span",{className:"font-medium text-gray-900",children:t.company_name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:t.industry||"—"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:t.location||"—"}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("span",{className:"inline-flex items-center gap-1 bg-primary-50 text-primary-700 px-2 py-0.5 rounded text-sm",children:[e.jsx($,{className:"w-3 h-3"})," ",t.active_jobs_count||0]})}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsx("button",{onClick:()=>S(t),className:"p-1.5 text-gray-400 hover:text-primary-600",children:e.jsx(D,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(t.id),className:"p-1.5 text-gray-400 hover:text-red-600 ml-1",children:e.jsx(F,{className:"w-4 h-4"})})]})]},t.id))})]})}),k&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:n?"Edit Client":"Add Client"}),e.jsx("button",{onClick:()=>l(!1),children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[[["company_name","Company Name *","text"],["industry","Industry","text"],["location","Location","text"],["website","Website","url"],["contact_name","Contact Name","text"],["contact_email","Contact Email","email"],["contact_phone","Contact Phone","text"],["logo_url","Logo URL","url"]].map(([t,s,d])=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s}),e.jsx("input",{type:d,value:c[t]||"",onChange:h=>o(L=>({...L,[t]:h.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]},t)),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{rows:3,value:c.description||"",onChange:t=>o(s=>({...s,description:t.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{onClick:E,disabled:f,className:"bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50",children:f?"Saving...":n?"Update":"Create"})]})]})})]})}export{R as default};
