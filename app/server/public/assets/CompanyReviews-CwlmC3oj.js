import{j as e,u as v,a6 as p,aF as R,aG as F,aH as D}from"./vendor-ui-K43rUeTs.js";import{d as P,r as n,L as u}from"./vendor-react-Dlyf-RJj.js";import{u as L,c as $,d as E,r as N,P as T}from"./index-CAGaxXNg.js";function H(){const{id:c}=P(),{user:o}=L(),{showToast:d}=$(),[t,f]=n.useState(null),[y,w]=n.useState([]),[a,_]=n.useState(null),[k,b]=n.useState(!0),[g,x]=n.useState(!1),[r,l]=n.useState({rating:5,title:"",pros:"",cons:"",advice:"",is_current_employee:!1});n.useEffect(()=>{C()},[c]);const C=async()=>{try{b(!0);const[s,i]=await Promise.all([E.get(c),N.getForCompany(c)]);f(s),w(i.reviews||[]),_(i.stats||{})}catch(s){d(s.message||"Failed to load reviews","error")}finally{b(!1)}},S=async s=>{if(s.preventDefault(),!o){d("Please login to submit a review","error");return}try{await N.create({company_id:parseInt(c),...r}),d("Review submitted successfully! It will be visible after approval.","success"),x(!1),l({rating:5,title:"",pros:"",cons:"",advice:"",is_current_employee:!1})}catch(i){d(i.message||"Failed to submit review","error")}},j=s=>[...Array(5)].map((i,h)=>e.jsx(p,{className:`w-5 h-5 ${h<s?"text-yellow-400 fill-current":"text-gray-300"}`},h)),m=s=>{const i=(a==null?void 0:a.total_reviews)||1,h=(s||0)/i*100;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-400 h-2 rounded-full",style:{width:`${h}%`}})}),e.jsx("span",{className:"text-sm text-gray-600 w-12 text-right",children:s||0})]})};return k?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t?e.jsxs(e.Fragment,{children:[e.jsx(T,{title:`${t.name} Reviews - WantokJobs`,description:`Read employee reviews and ratings for ${t.name}. Learn about company culture, benefits, pros and cons from current and former employees.`}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.logo_url?e.jsx("img",{src:t.logo_url,alt:t.name,className:"w-20 h-20 object-contain rounded border border-gray-200"}):e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded flex items-center justify-center",children:e.jsx(v,{className:"w-10 h-10 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:t.name}),e.jsx(u,{to:`/companies/${c}`,className:"text-primary-600 hover:text-primary-700",children:"View Company Profile →"})]})]})}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Employee Reviews (",(a==null?void 0:a.total_reviews)||0,")"]}),o&&e.jsx("button",{onClick:()=>x(!g),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:g?"Cancel":"Write Review"})]}),g&&e.jsxs("form",{onSubmit:S,className:"mb-6 p-6 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Share Your Experience"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overall Rating *"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>l({...r,rating:s}),className:"focus:outline-none",children:e.jsx(p,{className:`w-8 h-8 ${s<=r.rating?"text-yellow-400 fill-current":"text-gray-300"}`})},s))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Title"}),e.jsx("input",{type:"text",value:r.title,onChange:s=>l({...r,title:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"e.g., Great place to work"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pros (What you liked) *"}),e.jsx("textarea",{value:r.pros,onChange:s=>l({...r,pros:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",rows:"3",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cons (What could be improved) *"}),e.jsx("textarea",{value:r.cons,onChange:s=>l({...r,cons:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",rows:"3",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Advice to Management"}),e.jsx("textarea",{value:r.advice,onChange:s=>l({...r,advice:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",rows:"2",placeholder:"Optional"})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",id:"current_employee",checked:r.is_current_employee,onChange:s=>l({...r,is_current_employee:s.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),e.jsx("label",{htmlFor:"current_employee",className:"ml-2 text-sm text-gray-700",children:"I am a current employee"})]}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Submit Review"})]}),y.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No reviews yet"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Be the first to review ",t.name,"!"]}),o&&e.jsx("button",{onClick:()=>x(!0),className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Write a Review"})]}):e.jsx("div",{className:"space-y-6",children:y.map(s=>e.jsxs("div",{className:"border-b border-gray-200 pb-6 last:border-0",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-1 mb-2",children:j(s.rating)}),s.title&&e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:s.title}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.reviewer_name||"Anonymous"," •"," ",s.is_current_employee?"Current":"Former"," Employee •"," ",new Date(s.created_at).toLocaleDateString()]})]})}),s.pros&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(R,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Pros: "}),e.jsx("span",{className:"text-gray-700",children:s.pros})]})]})}),s.cons&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(F,{className:"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Cons: "}),e.jsx("span",{className:"text-gray-700",children:s.cons})]})]})}),s.advice&&e.jsx("div",{children:e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(D,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Advice to Management: "}),e.jsx("span",{className:"text-gray-700",children:s.advice})]})]})})]},s.id))})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Overall Rating"}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-5xl font-bold text-gray-900 mb-2",children:a!=null&&a.average_rating?a.average_rating.toFixed(1):"0.0"}),e.jsx("div",{className:"flex justify-center gap-1 mb-2",children:j(Math.round((a==null?void 0:a.average_rating)||0))}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Based on ",(a==null?void 0:a.total_reviews)||0," review",(a==null?void 0:a.total_reviews)!==1?"s":""]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 w-16",children:"5 stars"}),m(a==null?void 0:a.five_star)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 w-16",children:"4 stars"}),m(a==null?void 0:a.four_star)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 w-16",children:"3 stars"}),m(a==null?void 0:a.three_star)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 w-16",children:"2 stars"}),m(a==null?void 0:a.two_star)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 w-16",children:"1 star"}),m(a==null?void 0:a.one_star)]})]})]}),e.jsxs("div",{className:"bg-primary-50 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Have you worked here?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Share your experience to help others make informed career decisions."}),o?e.jsx("button",{onClick:()=>x(!0),className:"w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Write a Review"}):e.jsx(u,{to:"/login",className:"block w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 text-center",children:"Login to Review"})]})]})]})]})]}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12 text-center",children:[e.jsx(v,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Company Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The company you're looking for doesn't exist."}),e.jsx(u,{to:"/companies",className:"text-primary-600 hover:text-primary-700 font-semibold",children:"Browse Companies"})]})}export{H as default};
