import{j as e,Z as S,a as C,am as k,ap as u,bf as h,n as g,F as D,aA as O,x as T}from"./vendor-ui-K43rUeTs.js";import{d as F,u as P,r as o}from"./vendor-react-Dlyf-RJj.js";import{c as A}from"./index-CAGaxXNg.js";function U(){const{id:c}=F(),p=P(),{showToast:i}=A(),[E,B]=o.useState([]),[s,b]=o.useState(null),[y,d]=o.useState(!0),[f,m]=o.useState(!1),[t,r]=o.useState({});o.useEffect(()=>{c?x(c):j()},[c]);const j=async()=>{try{d(!1)}catch(a){console.error("Failed to load offers:",a),d(!1)}},x=async a=>{try{const l=await fetch(`/api/offer-letters/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!l.ok)throw new Error("Failed to load offer");const n=await l.json();b(n),r(n)}catch{i("Failed to load offer","error"),p(-1)}finally{d(!1)}},N=async()=>{try{if(!(await fetch(`/api/offer-letters/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(t)})).ok)throw new Error("Failed to update offer");i("Offer updated successfully","success"),m(!1),x(s.id)}catch(a){i("Failed to update offer: "+a.message,"error")}},v=async()=>{if(confirm("Send this offer to the candidate? They will receive an email with the offer details."))try{if(!(await fetch(`/api/offer-letters/${s.id}/send`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({expires_in_days:7})})).ok)throw new Error("Failed to send offer");i("Offer sent successfully!","success"),x(s.id)}catch(a){i("Failed to send offer: "+a.message,"error")}},w=a=>{const l={draft:{color:"bg-gray-100 text-gray-800",icon:h,label:"Draft"},sent:{color:"bg-blue-100 text-blue-800",icon:g,label:"Sent"},accepted:{color:"bg-green-100 text-green-800",icon:T,label:"Accepted"},declined:{color:"bg-red-100 text-red-800",icon:O,label:"Declined"},expired:{color:"bg-orange-100 text-orange-800",icon:u,label:"Expired"}},n=l[a]||l.draft,_=n.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${n.color}`,children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),n.label]})};return y?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})}):s?e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Offer Letter"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[s.candidate_name," - ",s.job_title]})]}),w(s.status)]}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 p-8 mb-6",children:f?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary"}),e.jsx("input",{type:"number",value:t.salary||"",onChange:a=>r({...t,salary:parseFloat(a.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:t.salary_currency||"PGK",onChange:a=>r({...t,salary_currency:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"PGK",children:"PGK"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"AUD",children:"AUD"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Period"}),e.jsxs("select",{value:t.salary_period||"annual",onChange:a=>r({...t,salary_period:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"annual",children:"Annual"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"weekly",children:"Weekly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Type"}),e.jsxs("select",{value:t.employment_type||"",onChange:a=>r({...t,employment_type:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"full-time",children:"Full-time"}),e.jsx("option",{value:"part-time",children:"Part-time"}),e.jsx("option",{value:"contract",children:"Contract"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:t.start_date||"",onChange:a=>r({...t,start_date:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Probation (months)"}),e.jsx("input",{type:"number",value:t.probation_months||3,onChange:a=>r({...t,probation_months:parseInt(a.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Benefits"}),e.jsx("textarea",{value:t.benefits||"",onChange:a=>r({...t,benefits:a.target.value}),rows:"4",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"List benefits (e.g., health insurance, paid leave, etc.)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Terms"}),e.jsx("textarea",{value:t.additional_terms||"",onChange:a=>r({...t,additional_terms:a.target.value}),rows:"4",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Any additional terms and conditions"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:N,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Save Changes"}),e.jsx("button",{onClick:()=>{m(!1),r(s)},className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Job Offer Letter"}),e.jsx("p",{className:"text-gray-600",children:s.company_name})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-700",children:["Dear ",s.candidate_name,","]}),e.jsxs("p",{className:"text-gray-700",children:["We are pleased to offer you the position of ",e.jsx("strong",{children:s.job_title})," at ",s.company_name,"."]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 my-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Offer Details"}),e.jsxs("div",{className:"space-y-3",children:[s.salary&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-5 w-5 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Salary:"}),e.jsxs("span",{className:"ml-2 font-semibold text-gray-900",children:[s.salary_currency," ",s.salary.toLocaleString()," (",s.salary_period,")"]})]})]}),s.employment_type&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-5 w-5 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Employment Type:"}),e.jsx("span",{className:"ml-2 font-semibold text-gray-900 capitalize",children:s.employment_type})]})]}),s.start_date&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-5 w-5 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Start Date:"}),e.jsx("span",{className:"ml-2 font-semibold text-gray-900",children:new Date(s.start_date).toLocaleDateString()})]})]}),s.probation_months&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"h-5 w-5 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Probation Period:"}),e.jsxs("span",{className:"ml-2 font-semibold text-gray-900",children:[s.probation_months," months"]})]})]})]})]}),s.benefits&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Benefits"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.benefits})]}),s.additional_terms&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Additional Terms"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.additional_terms})]}),s.expires_at&&s.status==="sent"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-800",children:e.jsxs("strong",{children:["This offer expires on ",new Date(s.expires_at).toLocaleDateString()]})})}),e.jsx("p",{className:"text-gray-700 mt-6",children:"We look forward to having you join our team!"}),e.jsxs("p",{className:"text-gray-700",children:["Best regards,",e.jsx("br",{}),s.company_name]})]})]})}),s.status==="draft"&&!f&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>m(!0),className:"flex-1 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium flex items-center justify-center",children:[e.jsx(h,{className:"h-5 w-5 mr-2"}),"Edit Offer"]}),e.jsxs("button",{onClick:v,className:"flex-1 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium flex items-center justify-center",children:[e.jsx(g,{className:"h-5 w-5 mr-2"}),"Send to Candidate"]})]})]}):e.jsxs("div",{className:"max-w-6xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Offer Letters"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center text-gray-500",children:[e.jsx(D,{className:"h-16 w-16 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No offer letters yet. Create an offer from the applicants page."})]})]})}export{U as default};
