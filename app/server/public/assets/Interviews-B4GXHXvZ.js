import{j as e}from"./vendor-ui-K43rUeTs.js";import{r as n}from"./vendor-react-Dlyf-RJj.js";import{a as p}from"./index-CAGaxXNg.js";const k={proposed:"bg-yellow-100 text-yellow-800",scheduled:"bg-blue-100 text-blue-800",confirmed:"bg-green-100 text-green-800",completed:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800","no-show":"bg-red-100 text-red-700"};function h(d){return d?new Date(d).toLocaleString("en-PG",{dateStyle:"medium",timeStyle:"short"}):"â€”"}function z(){const[d,N]=n.useState([]),[_,b]=n.useState(!0),[g,S]=n.useState("upcoming"),[C,c]=n.useState(!1),[A,I]=n.useState([]),[r,i]=n.useState({application_id:"",times:[""],type:"in-person",location:"",video_link:"",notes:"",duration_minutes:60}),[y,v]=n.useState(!1),[j,m]=n.useState(""),[u,f]=n.useState("list"),x=n.useCallback(async()=>{try{b(!0);const t=await p.get(`/interviews?period=${g}`);N(Array.isArray(t)?t:[])}catch(t){console.error(t)}finally{b(!1)}},[g]);n.useEffect(()=>{x()},[x]);const L=async()=>{try{const t=await p.get("/applications?status=screening,shortlisted,interview&role=employer");I(Array.isArray(t==null?void 0:t.applications)?t.applications:Array.isArray(t)?t:[])}catch(t){console.error(t)}},w=(t="")=>{i({application_id:t,times:[""],type:"in-person",location:"",video_link:"",notes:"",duration_minutes:60}),m(""),L(),c(!0)},$=()=>{r.times.length<3&&i(t=>({...t,times:[...t.times,""]}))},P=t=>{i(s=>({...s,times:s.times.filter((a,l)=>l!==t)}))},T=(t,s)=>{i(a=>({...a,times:a.times.map((l,O)=>O===t?s:l)}))},D=async t=>{t.preventDefault();const s=r.times.filter(Boolean);if(!r.application_id||s.length===0){m("Please select an applicant and at least one time slot");return}v(!0),m("");try{await p.post("/interviews",{application_id:parseInt(r.application_id),proposed_times:s,type:r.type,location:r.location||void 0,video_link:r.video_link||void 0,notes:r.notes||void 0,duration_minutes:r.duration_minutes}),c(!1),x()}catch(a){m(a.message||"Failed to schedule interview")}finally{v(!1)}},E=async t=>{if(confirm("Cancel this interview?"))try{await p.patch(`/interviews/${t}/cancel`,{}),x()}catch(s){alert(s.message)}},o={};return d.filter(t=>t.status!=="cancelled").forEach(t=>{var l;const s=t.confirmed_time||t.scheduled_at||((l=t.proposed_times)==null?void 0:l[0]);if(!s)return;const a=new Date(s).toLocaleDateString("en-PG",{dateStyle:"medium"});o[a]||(o[a]=[]),o[a].push(t)}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Interviews"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>w(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"+ Schedule Interview"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-between",children:[e.jsx("div",{className:"flex gap-2",children:["upcoming","past","all"].map(t=>e.jsx("button",{onClick:()=>S(t),className:`px-3 py-1.5 rounded-lg text-sm font-medium ${g===t?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsxs("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-0.5",children:[e.jsx("button",{onClick:()=>f("list"),className:`px-3 py-1 rounded text-sm ${u==="list"?"bg-white dark:bg-gray-600 shadow-sm":""}`,children:"List"}),e.jsx("button",{onClick:()=>f("calendar"),className:`px-3 py-1 rounded text-sm ${u==="calendar"?"bg-white dark:bg-gray-600 shadow-sm":""}`,children:"Calendar"})]})]}),_?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading..."}):d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No interviews found"}),e.jsx("button",{onClick:()=>w(),className:"text-blue-600 hover:underline",children:"Schedule your first interview"})]}):u==="list"?e.jsx("div",{className:"space-y-3",children:d.map(t=>{var s;return e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 sm:p-5",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white truncate",children:t.applicant_name}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${k[t.status]||"bg-gray-100"}`,children:t.status})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:t.job_title}),t.status==="proposed"&&((s=t.proposed_times)==null?void 0:s.length)>0?e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Proposed times:"}),e.jsx("ul",{className:"mt-1 space-y-0.5",children:t.proposed_times.map((a,l)=>e.jsxs("li",{className:"text-gray-700 dark:text-gray-300",children:["â€¢ ",h(a)]},l))}),e.jsx("p",{className:"text-yellow-600 text-xs mt-1",children:"â³ Awaiting applicant confirmation"})]}):e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["ðŸ“… ",h(t.confirmed_time||t.scheduled_at),t.duration_minutes&&` Â· ${t.duration_minutes} min`]}),t.location&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["ðŸ“ ",t.location]}),t.video_link&&e.jsx("p",{className:"text-sm text-blue-500 mt-1",children:e.jsx("a",{href:t.video_link,target:"_blank",rel:"noreferrer",children:"ðŸ”— Video Link"})}),t.notes&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1 italic",children:['"',t.notes,'"']})]}),e.jsx("div",{className:"flex gap-2",children:["proposed","scheduled","confirmed"].includes(t.status)&&e.jsx("button",{onClick:()=>E(t.id),className:"px-3 py-1.5 text-sm text-red-600 border border-red-200 rounded-lg hover:bg-red-50",children:"Cancel"})})]})},t.id)})}):e.jsx("div",{className:"space-y-6",children:Object.keys(o).length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No upcoming interviews to display"}):Object.entries(o).map(([t,s])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-2 uppercase tracking-wide",children:t}),e.jsx("div",{className:"space-y-2",children:s.map(a=>{var l;return e.jsxs("div",{className:"flex items-center gap-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3",children:[e.jsx("div",{className:`w-1 h-12 rounded-full ${a.status==="confirmed"?"bg-green-500":a.status==="proposed"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white text-sm truncate",children:[a.applicant_name," â€” ",a.job_title]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[h(a.confirmed_time||a.scheduled_at||((l=a.proposed_times)==null?void 0:l[0]))," Â· ",a.type," Â· ",a.duration_minutes,"min"]})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${k[a.status]}`,children:a.status})]},a.id)})})]},t))}),C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>c(!1),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto p-6",onClick:t=>t.stopPropagation(),children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Schedule Interview"}),j&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:j}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Applicant"}),e.jsxs("select",{value:r.application_id,onChange:t=>i(s=>({...s,application_id:t.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2.5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[e.jsx("option",{value:"",children:"Select an applicant..."}),A.map(t=>e.jsxs("option",{value:t.id,children:[t.applicant_name||t.name," â€” ",t.job_title||"Job"]},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Proposed Time Slots ",e.jsx("span",{className:"text-gray-400",children:"(up to 3)"})]}),r.times.map((t,s)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"datetime-local",value:t,onChange:a=>T(s,a.target.value),className:"flex-1 border border-gray-300 dark:border-gray-600 rounded-lg p-2.5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),r.times.length>1&&e.jsx("button",{type:"button",onClick:()=>P(s),className:"px-2 text-red-500 hover:text-red-700",children:"âœ•"})]},s)),r.times.length<3&&e.jsx("button",{type:"button",onClick:$,className:"text-sm text-blue-600 hover:underline",children:"+ Add another time slot"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),e.jsxs("select",{value:r.type,onChange:t=>i(s=>({...s,type:t.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2.5 bg-white dark:bg-gray-700 text-sm",children:[e.jsx("option",{value:"in-person",children:"In Person"}),e.jsx("option",{value:"video",children:"Video Call"}),e.jsx("option",{value:"phone",children:"Phone"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Duration"}),e.jsxs("select",{value:r.duration_minutes,onChange:t=>i(s=>({...s,duration_minutes:parseInt(t.target.value)})),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2.5 bg-white dark:bg-gray-700 text-sm",children:[e.jsx("option",{value:30,children:"30 min"}),e.jsx("option",{value:45,children:"45 min"}),e.jsx("option",{value:60,children:"1 hour"}),e.jsx("option",{value:90,children:"1.5 hours"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.type==="video"?"Video Link":"Location"}),r.type==="video"?e.jsx("input",{type:"url",placeholder:"https://zoom.us/j/...",value:r.video_link,onChange:t=>i(s=>({...s,video_link:t.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2.5 bg-white dark:bg-gray-700 text-sm"}):e.jsx("input",{type:"text",placeholder:"Office address...",value:r.location,onChange:t=>i(s=>({...s,location:t.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2.5 bg-white dark:bg-gray-700 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{rows:3,placeholder:"Anything the applicant should know...",value:r.notes,onChange:t=>i(s=>({...s,notes:t.target.value})),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2.5 bg-white dark:bg-gray-700 text-sm"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:y,className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:y?"Sending...":"Send Interview Invite"})]})]})]})})]})}export{z as default};
