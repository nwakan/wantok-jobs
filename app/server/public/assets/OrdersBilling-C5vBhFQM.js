import{j as e,bk as b,a9 as m,S as j,bl as C,T as $,aA as f,x as N,ap as h}from"./vendor-ui-K43rUeTs.js";import{r as c}from"./vendor-react-Dlyf-RJj.js";const g="/api";async function x(s){const r=localStorage.getItem("token"),a=await fetch(`${g}${s}`,{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`API error ${a.status}`);return a.json()}function p({label:s,icon:r,current:a,color:n="primary"}){return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(r,{className:`w-5 h-5 text-${n}-600`}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s})]}),e.jsx("p",{className:`text-3xl font-bold text-${n}-600`,children:a}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"credits remaining"})]})}function P({trial:s,trialUsed:r}){if((s==null?void 0:s.type)==="premium_indefinite")return e.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(m,{className:"w-6 h-6 text-amber-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-amber-800",children:"Premium Access â€” Unlimited"}),e.jsx("p",{className:"text-sm text-amber-600",children:"All features unlocked. No credits consumed."})]})]});if((s==null?void 0:s.type)==="standard"){const a=Math.max(0,Math.ceil((new Date(s.expiresAt)-Date.now())/864e5));return e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(h,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-blue-800",children:["Free Trial Active â€” ",a," days left"]}),e.jsx("p",{className:"text-sm text-blue-600",children:"All features available. No credits consumed during trial."})]})]})}return r?null:e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{className:"w-6 h-6 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-green-800",children:"Free Trial Available!"}),e.jsx("p",{className:"text-sm text-green-600",children:"Start your 14-day trial with free credits. No payment needed."})]})]}),e.jsx("button",{onClick:async()=>{const a=localStorage.getItem("token");(await fetch(`${g}/credits/trial/activate`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).ok&&window.location.reload()},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-700 transition text-sm",children:"Activate Trial"})]})}const T={pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",failed:"bg-red-100 text-red-800",overdue:"bg-orange-100 text-orange-800"},I={pending:h,approved:N,completed:N,rejected:f,failed:f,overdue:$};function L(){const[s,r]=c.useState(null),[a,n]=c.useState([]),[u,v]=c.useState([]),[y,w]=c.useState([]),[_,k]=c.useState(!0),[o,A]=c.useState("credits");return c.useEffect(()=>{Promise.all([x("/credits/status").catch(()=>null),x("/orders/my").then(t=>t.orders||[]).catch(()=>[]),x("/credits/transactions").then(t=>t.transactions||[]).catch(()=>[]),x("/credits/packages").then(t=>t.packages||[]).catch(()=>[])]).then(([t,l,i,d])=>{r(t),n(l),v(i),w(d.filter(S=>S.price>0)),k(!1)})},[]),_?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Credits & Billing"}),e.jsx("div",{className:"mb-6",children:e.jsx(P,{trial:s==null?void 0:s.trial,trialUsed:s==null?void 0:s.trialUsed})}),(s==null?void 0:s.credits)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[e.jsx(p,{label:"Job Posting",icon:b,current:s.credits.job_posting,color:"primary"}),e.jsx(p,{label:"AI Matching",icon:m,current:s.credits.ai_matching,color:"purple"}),e.jsx(p,{label:"Candidate Search",icon:j,current:s.credits.candidate_search,color:"blue"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex -mb-px",children:[{key:"credits",label:"Buy Credits"},{key:"orders",label:"Order History"},{key:"transactions",label:"Credit Log"}].map(t=>e.jsx("button",{onClick:()=>A(t.key),className:`py-3 px-6 font-medium text-sm border-b-2 transition ${o===t.key?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:t.label},t.key))})}),e.jsxs("div",{className:"p-6",children:[o==="credits"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Available Packages"}),y.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No packages available"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:y.map(t=>e.jsxs("div",{className:`border rounded-lg p-5 ${t.popular?"border-primary-500 bg-primary-50":"border-gray-200"}`,children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t.name}),e.jsxs("p",{className:"text-3xl font-bold text-primary-600 mt-1",children:["K",t.price.toLocaleString()]}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"one-time purchase"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.description}),e.jsxs("div",{className:"space-y-1 mb-4 text-sm",children:[t.job_posting_credits>0&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(b,{className:"w-4 h-4 text-primary-500"})," ",t.job_posting_credits," job posting credits"]}),t.ai_matching_credits>0&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(m,{className:"w-4 h-4 text-purple-500"})," ",t.ai_matching_credits===999?"Unlimited":t.ai_matching_credits," AI matching"]}),t.candidate_search_credits>0&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(j,{className:"w-4 h-4 text-blue-500"})," ",t.candidate_search_credits===999?"Unlimited":t.candidate_search_credits," candidate searches"]})]}),e.jsxs("button",{onClick:async()=>{const l=localStorage.getItem("token"),i=await fetch(`${g}/orders`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({package_id:t.id,payment_method:"bank_transfer"})}),d=await i.json();i.ok?(alert(`Order created! Invoice: ${d.order.invoice_number}

${d.instructions}`),window.location.reload()):alert(d.error||"Failed to create order")},className:"w-full py-2.5 bg-primary-600 text-white rounded-lg font-semibold hover:bg-primary-700 transition flex items-center justify-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"})," Purchase"]})]},t.id))}),e.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-blue-800",children:[e.jsx("strong",{children:"ðŸ’³ Payment:"})," After purchasing, transfer the amount to our BSP bank account using your invoice number as reference. Credits will be added within 24 hours of verification."]})]}),o==="orders"&&e.jsx("div",{children:a.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No orders yet. Purchase a credit package to get started!"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Package"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map(t=>{var i;const l=I[t.status]||h;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-gray-900",children:t.invoice_number}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:t.package_name||"â€”"}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:["K",(i=t.amount)==null?void 0:i.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-0.5 text-xs font-semibold rounded-full ${T[t.status]||"bg-gray-100 text-gray-800"}`,children:[e.jsx(l,{className:"w-3.5 h-3.5"}),t.status]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()})]},t.id)})})]})})}),o==="transactions"&&e.jsx("div",{children:u.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No credit transactions yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reason"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 capitalize",children:t.credit_type.replace("_"," ")}),e.jsxs("td",{className:`px-4 py-3 text-sm font-semibold ${t.amount>0?"text-green-600":"text-red-600"}`,children:[t.amount>0?"+":"",t.amount]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:t.balance_after}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 capitalize",children:t.reason.replace("_"," ")})]},t.id))})]})})})]})]})]})}export{L as default};
