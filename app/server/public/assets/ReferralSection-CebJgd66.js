import{j as e,X as j,ac as k,R as w,aD as N,ao as f,ah as y,f as v,ai as C,U as S,Z as R}from"./vendor-ui-K43rUeTs.js";import{r}from"./vendor-react-Dlyf-RJj.js";import{i as u}from"./index-CAGaxXNg.js";function P({user:s,onDismiss:d}){const[l,o]=r.useState(!1),[a,n]=r.useState(""),[c,x]=r.useState(!1);if(s!=null&&s.email_verified||c)return null;const g=async()=>{o(!0),n("");try{const i=await fetch("/api/auth/resend-verification",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}}),b=await i.json();i.ok?n("✓ Verification email sent! Please check your inbox."):n("Failed to send email. Please try again later.")}catch(i){n("An error occurred. Please try again."),console.error("Resend verification error:",i)}finally{o(!1)}},h=()=>{x(!0),d&&d()};return e.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 relative",children:[e.jsx("button",{onClick:h,className:"absolute top-2 right-2 text-yellow-700 hover:text-yellow-900","aria-label":"Dismiss",children:e.jsx(j,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(k,{className:"w-5 h-5 text-yellow-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Please verify your email address"}),e.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[e.jsxs("p",{className:"mb-2",children:["We sent a verification email to ",e.jsx("strong",{children:s==null?void 0:s.email}),". Click the link in the email to verify your account and unlock all features."]}),a&&e.jsx("p",{className:`mb-2 ${a.startsWith("✓")?"text-green-700 font-medium":"text-red-700"}`,children:a}),e.jsxs("button",{onClick:g,disabled:l,className:"inline-flex items-center gap-1 text-yellow-800 hover:text-yellow-900 font-medium disabled:opacity-50",children:[e.jsx(w,{className:`w-4 h-4 ${l?"animate-spin":""}`}),l?"Sending...":"Resend verification email"]})]})]})]})]})}function W(){const[s,d]=r.useState(""),[l,o]=r.useState(""),[a,n]=r.useState({total_referred:0,completed:0,total_credits:0,recent:[]}),[c,x]=r.useState(!1),[g,h]=r.useState(!0);r.useEffect(()=>{Promise.all([u.getMyCode().catch(()=>null),u.getStats().catch(()=>null)]).then(([t,m])=>{t&&(d(t.code),o(t.link)),m&&n(m),h(!1)})},[]);const i=()=>{navigator.clipboard.writeText(l).then(()=>{x(!0),setTimeout(()=>x(!1),2e3)})},b=()=>{const t=`Join WantokJobs and get 25 free credits! Use my referral link: ${l}`;window.open(`https://wa.me/?text=${encodeURIComponent(t)}`,"_blank")},p=()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(l)}`,"_blank")};return g?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]}):e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 dark:from-gray-800 dark:to-gray-750 rounded-xl shadow-sm border border-orange-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-amber-500 px-6 py-4 flex items-center gap-3",children:[e.jsx(N,{className:"w-8 h-8 text-white flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:"Refer a Friend, Earn 50 Credits!"}),e.jsx("p",{className:"text-orange-100 text-sm",children:"Your friend gets 25 credits too. Win-win!"})]})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Your Referral Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2.5 font-mono text-lg font-bold text-orange-600 dark:text-orange-400 select-all",children:s}),e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2.5 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors font-medium",children:[c?e.jsx(f,{className:"w-4 h-4"}):e.jsx(y,{className:"w-4 h-4"}),c?"Copied!":"Copy Link"]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 truncate",children:l})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:b,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors font-medium",children:[e.jsx(v,{className:"w-4 h-4"}),"WhatsApp"]}),e.jsxs("button",{onClick:p,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(C,{className:"w-4 h-4"}),"Facebook"]}),e.jsxs("button",{onClick:i,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors font-medium",children:[e.jsx(y,{className:"w-4 h-4"}),"Copy"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-3 text-center border border-gray-200 dark:border-gray-600",children:[e.jsx(S,{className:"w-5 h-5 text-blue-500 mx-auto mb-1"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.total_referred}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Referred"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-3 text-center border border-gray-200 dark:border-gray-600",children:[e.jsx(f,{className:"w-5 h-5 text-green-500 mx-auto mb-1"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.completed}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Joined"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-3 text-center border border-gray-200 dark:border-gray-600",children:[e.jsx(R,{className:"w-5 h-5 text-orange-500 mx-auto mb-1"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.total_credits}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Credits Earned"})]})]}),a.recent&&a.recent.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:"Recent Referrals"}),e.jsx("div",{className:"space-y-2",children:a.recent.slice(0,5).map((t,m)=>e.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-gray-700 rounded-lg px-3 py-2 text-sm border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t.referred_name||t.referred_email}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${t.status==="credited"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":t.status==="completed"?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-gray-100 text-gray-600 dark:bg-gray-600 dark:text-gray-300"}`,children:t.status==="credited"?`+${t.credits_earned} credits`:t.status})]},m))})]})]})]})}export{P as E,W as R};
