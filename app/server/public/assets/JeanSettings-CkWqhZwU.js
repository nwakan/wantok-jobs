import{j as e,bt as L,R,ak as P,bu as z,ba as F,bv as U}from"./vendor-ui-K43rUeTs.js";import{r as i}from"./vendor-react-Dlyf-RJj.js";const x="/api";function g(){const r=localStorage.getItem("token");return r?{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}:{}}const G=[{key:"jean_enabled",label:"Jean AI Assistant",desc:"Master toggle â€” disables the entire chat widget"},{key:"voice_enabled",label:"Voice Input/Output",desc:"Allow speech-to-text and text-to-speech"},{key:"auto_apply_enabled",label:"Auto-Apply (Jobseekers)",desc:"Allow jobseekers to set up automatic job applications"},{key:"auto_post_enabled",label:"Auto-Post Jobs (Employers)",desc:"Allow employers to auto-post from uploaded documents"},{key:"linkedin_import_enabled",label:"LinkedIn Import",desc:"Allow profile import from LinkedIn URLs"},{key:"document_parse_enabled",label:"Document Parsing",desc:"Allow PDF/Word upload for job creation"},{key:"guest_chat_enabled",label:"Guest Chat",desc:"Allow non-logged-in visitors to chat with Jean"},{key:"proactive_triggers_enabled",label:"Proactive Suggestions",desc:"Show contextual chat suggestions on pages"}],O=[{key:"max_auto_apply_daily",label:"Max Auto-Apply Per Day",desc:"Maximum automatic applications per user per day",min:1,max:50},{key:"max_linkedin_scrapes_hourly",label:"LinkedIn Scrapes/Hour",desc:"Rate limit for LinkedIn profile imports",min:1,max:100},{key:"auto_apply_min_match_score",label:"Auto-Apply Min Match %",desc:"Minimum match score for auto-applications (0-100)",min:0,max:100}],D=[{key:"jean_greeting",label:"Greeting Message",desc:"First message Jean shows when chat opens"},{key:"jean_offline_message",label:"Offline Message",desc:"Message shown when Jean is disabled"}];function H(){var w,N,k,S,_;const[r,u]=i.useState({}),[l,A]=i.useState(null),[T,I]=i.useState(!0),[m,d]=i.useState(!1),[p,o]=i.useState(""),[b,c]=i.useState(""),[y,f]=i.useState({});i.useEffect(()=>{E(),h()},[]);const E=async()=>{try{const a=await(await fetch(`${x}/chat/admin/settings`,{headers:g()})).json(),s={};(a.settings||[]).forEach(n=>{s[n.key]=n.value}),u(s)}catch{o("Failed to load settings")}I(!1)},h=async()=>{try{const t=await fetch(`${x}/chat/admin/stats`,{headers:g()});A(await t.json())}catch{}},j=async(t,a)=>{u(s=>({...s,[t]:a})),f(s=>({...s,[t]:!0}))},M=async t=>{const a=r[t]==="true"?"false":"true";d(!0),o("");try{if(!(await fetch(`${x}/chat/admin/settings`,{method:"PUT",headers:g(),body:JSON.stringify({key:t,value:a})})).ok)throw new Error("Failed");u(n=>({...n,[t]:a})),c(`${t} updated`),setTimeout(()=>c(""),2e3)}catch{o(`Failed to update ${t}`)}d(!1)},v=async t=>{d(!0),o("");try{if(!(await fetch(`${x}/chat/admin/settings`,{method:"PUT",headers:g(),body:JSON.stringify({key:t,value:r[t]})})).ok)throw new Error("Failed");f(s=>({...s,[t]:!1})),c(`${t} saved`),setTimeout(()=>c(""),2e3)}catch{o(`Failed to save ${t}`)}d(!1)},$=async()=>{var t;d(!0);try{const s=await(await fetch(`${x}/chat/admin/run-auto-apply`,{method:"POST",headers:g()})).json();c(`Auto-apply run: ${((t=s.results)==null?void 0:t.applied)||0} applications made`),setTimeout(()=>c(""),5e3),h()}catch{o("Auto-apply run failed")}d(!1)};return T?e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Loading Jean settings..."}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:e.jsx(L,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Jean AI Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage your AI sales assistant"})]})]}),e.jsxs("button",{onClick:h,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(R,{size:14})," Refresh Stats"]})]}),p&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg flex items-center gap-2",children:[e.jsx(P,{size:16})," ",p]}),b&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-300 px-4 py-3 rounded-lg",children:b}),l&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[{label:"Sessions Today",value:((w=l.sessions)==null?void 0:w.today)||0,icon:"ðŸ’¬"},{label:"Messages Today",value:((N=l.messages)==null?void 0:N.today)||0,icon:"ðŸ“¨"},{label:"Unique Users",value:((k=l.sessions)==null?void 0:k.uniqueUsers)||0,icon:"ðŸ‘¤"},{label:"Auto-Applications",value:((S=l.autoApply)==null?void 0:S.applicationsToday)||0,icon:"ðŸ¤–"}].map((t,a)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border dark:border-gray-700 p-4 text-center",children:[e.jsx("div",{className:"text-2xl mb-1",children:t.icon}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.value}),e.jsx("div",{className:"text-xs text-gray-500",children:t.label})]},a))}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border dark:border-gray-700 divide-y dark:divide-gray-700",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(z,{size:18})," Feature Toggles"]})}),G.map(({key:t,label:a,desc:s})=>e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:a}),e.jsx("div",{className:"text-xs text-gray-500",children:s})]}),e.jsx("button",{onClick:()=>M(t),disabled:m,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r[t]==="true"?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r[t]==="true"?"translate-x-6":"translate-x-1"}`})})]},t))]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border dark:border-gray-700 divide-y dark:divide-gray-700",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(F,{size:18})," Limits & Thresholds"]})}),O.map(({key:t,label:a,desc:s,min:n,max:C})=>e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:a}),e.jsx("div",{className:"text-xs text-gray-500",children:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:n,max:C,value:r[t]||"",onChange:J=>j(t,J.target.value),className:"w-20 px-2 py-1 border rounded-lg text-sm text-center dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),y[t]&&e.jsx("button",{onClick:()=>v(t),disabled:m,className:"px-2 py-1 bg-blue-600 text-white text-xs rounded-lg hover:bg-blue-700",children:e.jsx(U,{size:12})})]})]},t))]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border dark:border-gray-700 divide-y dark:divide-gray-700",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white",children:"Messages"})}),D.map(({key:t,label:a,desc:s})=>e.jsxs("div",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm mb-1",children:a}),e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:s}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{value:r[t]||"",onChange:n=>j(t,n.target.value),className:"flex-1 px-3 py-2 border rounded-lg text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white resize-none",rows:2}),y[t]&&e.jsx("button",{onClick:()=>v(t),disabled:m,className:"px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 self-end",children:"Save"})]})]},t))]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Actions"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsx("button",{onClick:$,disabled:m||r.auto_apply_enabled!=="true",className:"px-4 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:"ðŸ¤– Run Auto-Apply Now"})}),r.auto_apply_enabled!=="true"&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Enable auto-apply to use this action"})]}),((_=l==null?void 0:l.topIntents)==null?void 0:_.length)>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Top Intents (Last 7 Days)"}),e.jsx("div",{className:"space-y-2",children:l.topIntents.filter(t=>t.intent).map((t,a)=>{var s;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.intent}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 rounded-full h-2",style:{width:`${Math.min(t.count/(((s=l.topIntents[0])==null?void 0:s.count)||1)*100,100)}%`}})}),e.jsx("span",{className:"text-xs text-gray-500 w-8 text-right",children:t.count})]})]},a)})})]})]})}export{H as default};
